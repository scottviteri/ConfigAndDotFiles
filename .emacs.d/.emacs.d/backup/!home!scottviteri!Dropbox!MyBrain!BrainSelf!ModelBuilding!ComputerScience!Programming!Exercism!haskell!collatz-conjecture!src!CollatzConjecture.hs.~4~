module CollatzConjecture (collatz) where

import qualified Data.List (elemIndex)

collatz :: Integer -> Maybe Integer
collatz start
    | start <= 0 = Nothing
    | start == 1 = Just 0
    | otherwise = toInteger <$> Data.List.elemIndex 1 collatzSequence
    where genNextCollatz n = if even n then (n `quot` 2) else (3*n + 1)
          collatzSequence = iterate genNextCollatz start
